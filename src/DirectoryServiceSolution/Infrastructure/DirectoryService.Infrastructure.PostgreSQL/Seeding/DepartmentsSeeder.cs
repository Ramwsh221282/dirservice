using DirectoryService.Core.DeparmentsContext;
using DirectoryService.Core.DeparmentsContext.ValueObjects;
using DirectoryService.Core.LocationsContext;
using DirectoryService.Infrastructure.PostgreSQL.EntityFramework;
using Microsoft.EntityFrameworkCore;
using Microsoft.EntityFrameworkCore.Storage;
using ResultLibrary;

namespace DirectoryService.Infrastructure.PostgreSQL.Seeding;

public sealed class DepartmentsSeeder : ISeeder
{
    private readonly ServiceDbContext _dbContext;
    private readonly Serilog.ILogger _logger;
    private readonly Random _random = new();
    private readonly DepartmentNameUniquesnessStub _nameUniquesnessStub;

    public DepartmentsSeeder(ServiceDbContext dbContext, Serilog.ILogger logger)
    {
        _dbContext = dbContext;
        _logger = logger;
        _nameUniquesnessStub = new DepartmentNameUniquesnessStub(dbContext);
    }

    public async Task SeedAsync()
    {
        _logger.Information("Seeding departments...");
        IDbContextTransaction txn = await _dbContext.Database.BeginTransactionAsync();

        try
        {
            await SeedData();
            await txn.CommitAsync();
        }
        catch (Exception ex)
        {
            _logger.Error(ex, "An error occurred seeding departments.");
            await txn.RollbackAsync();
        }

        _logger.Information("Departments seeded.");
    }

    private async Task SeedData()
    {
        List<Location> locations = await _dbContext.Locations.ToListAsync();

        List<Department> departments = [];

        var seedDepartments = new[]
        {
            // IT и разработка
            ("Отдел разработки", "dev"),
            ("Отдел тестирования", "qa"),
            ("Отдел аналитики", "analytics"),
            ("Отдел инфраструктуры", "infra"),
            ("Отдел DevOps", "devops"),
            ("Отдел мобильной разработки", "mobile"),
            ("Отдел фронтенда", "frontend"),
            ("Отдел бэкенда", "backend"),
            ("Отдел данных", "data"),
            ("Отдел машинного обучения", "ml"),
            ("Отдел искусственного интеллекта", "ai"),
            ("Отдел кибербезопасности", "cybersec"),
            ("Отдел информационной безопасности", "infosec"),
            ("Отдел сетевых технологий", "networking"),
            ("Отдел системного администрирования", "sysadmin"),
            // Бизнес-подразделения
            ("Отдел маркетинга", "marketing"),
            ("Отдел продаж", "sales"),
            ("Отдел закупок", "procurement"),
            ("Отдел логистики", "logistics"),
            ("Отдел цепочек поставок", "supplychain"),
            ("Отдел клиентского опыта", "cx"),
            ("Отдел поддержки клиентов", "support"),
            ("Отдел партнерских отношений", "partnerships"),
            ("Отдел стратегического развития", "strategy"),
            ("Отдел корпоративных коммуникаций", "comms"),
            // Финансы и управление
            ("Финансовый отдел", "finance"),
            ("Бухгалтерия", "accounting"),
            ("Отдел налогового планирования", "tax"),
            ("Отдел внутреннего аудита", "audit"),
            ("Отдел казначейства", "treasury"),
            ("Отдел бюджетирования", "budgeting"),
            ("Отдел управленческого учета", "managementaccounting"),
            // Персонал и культура
            ("HR-отдел", "hr"),
            ("Отдел подбора персонала", "recruitment"),
            ("Отдел обучения и развития", "lnd"),
            ("Отдел компенсаций и льгот", "compben"),
            ("Отдел организационного развития", "od"),
            ("Отдел корпоративной культуры", "culture"),
            ("Отдел кадрового делопроизводства", "personnel"),
            // Юридические и регуляторные
            ("Юридический отдел", "legal"),
            ("Отдел интеллектуальной собственности", "ip"),
            ("Отдел договорной работы", "contracts"),
            ("Отдел регуляторного соответствия", "compliance"),
            ("Отдел корпоративного права", "corplaw"),
            ("Отдел трудового права", "labourlaw"),
            // Операционные и вспомогательные
            ("Отдел документооборота", "docs"),
            ("Отдел администрирования", "admin"),
            ("Отдел закупок оборудования", "equipproc"),
            ("Отдел управления офисами", "facilities"),
            ("Отдел корпоративных путешествий", "travel"),
            ("Отдел внутренних расследований", "investigations"),
            ("Отдел качества", "quality"),
            ("Отдел стандартизации", "standards"),
            ("Отдел экологической устойчивости", "sustainability"),
            ("Отдел корпоративной социальной ответственности", "csr"),
            // Новые подразделения для иерархии
            ("Отдел архитектуры", "arch"),
            ("Отдел продуктов", "product"),
            ("Отдел пользовательского опыта", "ux"),
            ("Отдел исследований", "research"),
            ("Отдел внутренней безопасности", "intsec"),
            ("Отдел корпоративного развития", "corpdev"),
            ("Отдел инноваций", "innovation"),
            ("Отдел цифровой трансформации", "digital"),
            ("Отдел бизнес-анализа", "bizanalyst"),
            ("Отдел проектного управления", "pmo"),
            ("Отдел внутренней отчетности", "reporting"),
            ("Отдел корпоративного обучения", "corptraining"),
            ("Отдел внутренней коммуникации", "internalcomms"),
            ("Отдел охраны труда", "safety"),
            ("Отдел закупок ИТ", "itprocurement"),
            ("Отдел внутреннего аудита ИТ", "itaudit"),
            ("Отдел автоматизации процессов", "automation"),
            ("Отдел цифровых сервисов", "digitalservices"),
            ("Отдел управления знаниями", "knowledge"),
            ("Отдел этики", "ethics"),
            ("Отдел устойчивого развития", "sustdev"),
            ("Отдел стратегического планирования", "stratplan"),
            ("Отдел корпоративной стратегии", "corpstrategy"),
            ("Отдел развития лидерства", "leaddev"),
            ("Отдел корпоративной отчетности", "corpreporting"),
            ("Отдел интеграций", "integrations"),
            ("Отдел цифровой безопасности", "digitalsec"),
            ("Отдел управления данными", "datagov"),
            ("Отдел качества данных", "dataquality"),
            ("Отдел мониторинга", "monitoring"),
            ("Отдел аудита процессов", "processaudit"),
            ("Отдел анализа эффективности", "efficiency"),
            ("Отдел стратегического маркетинга", "stratmarketing"),
            ("Отдел рекламы", "advertising"),
            ("Отдел контент-маркетинга", "content"),
            ("Отдел SMM", "socialmedia"),
            ("Отдел аналитики маркетинга", "marketinganalytics"),
            ("Отдел управления брендом", "branding"),
            ("Отдел клиентского обслуживания", "customerservice"),
            ("Отдел поддержки пользователей", "usersupport"),
            ("Отдел технической поддержки", "techsupport"),
            ("Отдел обратной связи", "feedback"),
            ("Отдел корпоративных мероприятий", "events"),
            ("Отдел корпоративной культуры", "culture2"),
            ("Отдел внутреннего контроля", "internalcontrol"),
            ("Отдел управления рисками", "risk"),
            ("Отдел страхования", "insurance"),
            ("Отдел оценки персонала", "evaluation"),
            ("Отдел карьерного развития", "career"),
            ("Отдел мотивации персонала", "motivation"),
            ("Отдел корпоративного здоровья", "wellness"),
            ("Отдел внутреннего планирования", "internalplanning"),
            ("Отдел корпоративной безопасности", "corpsec"),
            ("Отдел контроля доступа", "accesscontrol"),
            ("Отдел управления инцидентами", "incident"),
            ("Отдел архивного хранения", "archive"),
            ("Отдел управления контрактами", "contractmgmt"),
            ("Отдел юридических рисков", "legalrisk"),
            ("Отдел международного права", "intllegal"),
            ("Отдел лицензирования", "licensing"),
            ("Отдел корпоративного соблюдения", "corpgov"),
            ("Отдел корпоративного управления", "corpgovernance"),
            ("Отдел внутреннего развития", "internaldev"),
            ("Отдел управления проектами", "projectmgmt"),
            ("Отдел планирования ресурсов", "resourceplanning"),
            ("Отдел управления бюджетами", "budgetmgmt"),
            ("Отдел внутреннего аудита ИТ", "itaudit2"),
            ("Отдел управления изменениями", "changemgmt"),
            ("Отдел корпоративного обучения", "learnings"),
            ("Отдел внутренней экспертизы", "expertise"),
            ("Отдел стратегических инициатив", "stratinitiatives"),
            ("Отдел корпоративных изменений", "corpchanges"),
            ("Отдел внутреннего развития", "intdev"),
            ("Отдел корпоративного планирования", "corpplan"),
            ("Отдел управления знаниями", "knowledgemgmt"),
            ("Отдел корпоративной стратегии", "corpstrat"),
            ("Отдел внутреннего развития", "intdev2"),
            ("Отдел корпоративного управления", "corpmanagement"),
            ("Отдел корпоративной культуры", "culture3"),
            ("Отдел корпоративной этики", "corpethics"),
            ("Отдел внутреннего развития", "intdev3"),
            ("Отдел корпоративного планирования", "corpplan2"),
            ("Отдел внутреннего развития", "intdev4"),
            ("Отдел корпоративного управления", "corpmanagement2"),
            ("Отдел корпоративной культуры", "culture4"),
            ("Отдел корпоративной стратегии", "corpstrat2"),
            ("Отдел внутреннего развития", "intdev5"),
            ("Отдел корпоративного управления", "corpmanagement3"),
            ("Отдел корпоративной культуры", "culture5"),
            ("Отдел корпоративной стратегии", "corpstrat3"),
            ("Отдел внутреннего развития", "intdev6"),
            ("Отдел корпоративного управления", "corpmanagement4"),
            ("Отдел корпоративной культуры", "culture6"),
            ("Отдел корпоративной стратегии", "corpstrat4"),
            ("Отдел внутреннего развития", "intdev7"),
            ("Отдел корпоративного управления", "corpmanagement5"),
            ("Отдел корпоративной культуры", "culture7"),
            ("Отдел корпоративной стратегии", "corpstrat5"),
            ("Отдел внутреннего развития", "intdev8"),
            ("Отдел корпоративного управления", "corpmanagement6"),
            ("Отдел корпоративной культуры", "culture8"),
            ("Отдел корпоративной стратегии", "corpstrat6"),
            ("Отдел внутреннего развития", "intdev9"),
            ("Отдел корпоративного управления", "corpmanagement7"),
            ("Отдел корпоративной культуры", "culture9"),
            ("Отдел корпоративной стратегии", "corpstrat7"),
            ("Отдел внутреннего развития", "intdev10"),
            ("Отдел корпоративного управления", "corpmanagement8"),
            ("Отдел корпоративной культуры", "culture10"),
            ("Отдел корпоративной стратегии", "corpstrat8"),
            ("Отдел внутреннего развития", "intdev11"),
            ("Отдел корпоративного управления", "corpmanagement9"),
            ("Отдел корпоративной культуры", "culture11"),
            ("Отдел корпоративной стратегии", "corpstrat9"),
            ("Отдел внутреннего развития", "intdev12"),
            ("Отдел корпоративного управления", "corpmanagement10"),
            ("Отдел корпоративной культуры", "culture12"),
            ("Отдел корпоративной стратегии", "corpstrat10"),
            ("Отдел внутреннего развития", "intdev13"),
            ("Отдел корпоративного управления", "corpmanagement11"),
            ("Отдел корпоративной культуры", "culture13"),
            ("Отдел корпоративной стратегии", "corpstrat11"),
            ("Отдел внутреннего развития", "intdev14"),
            ("Отдел корпоративного управления", "corpmanagement12"),
            ("Отдел корпоративной культуры", "culture14"),
            ("Отдел корпоративной стратегии", "corpstrat12"),
            ("Отдел внутреннего развития", "intdev15"),
            ("Отдел корпоративного управления", "corpmanagement13"),
            ("Отдел корпоративной культуры", "culture15"),
            ("Отдел корпоративной стратегии", "corpstrat13"),
            ("Отдел внутреннего развития", "intdev16"),
            ("Отдел корпоративного управления", "corpmanagement14"),
            ("Отдел корпоративной культуры", "culture16"),
            ("Отдел корпоративной стратегии", "corpstrat14"),
            ("Отдел внутреннего развития", "intdev17"),
            ("Отдел корпоративного управления", "corpmanagement15"),
            ("Отдел корпоративной культуры", "culture17"),
            ("Отдел корпоративной стратегии", "corpstrat15"),
            ("Отдел внутреннего развития", "intdev18"),
            ("Отдел корпоративного управления", "corpmanagement16"),
            ("Отдел корпоративной культуры", "culture18"),
            ("Отдел корпоративной стратегии", "corpstrat16"),
            ("Отдел внутреннего развития", "intdev19"),
            ("Отдел корпоративного управления", "corpmanagement17"),
            ("Отдел корпоративной культуры", "culture19"),
            ("Отдел корпоративной стратегии", "corpstrat17"),
            ("Отдел внутреннего развития", "intdev20"),
            ("Отдел корпоративного управления", "corpmanagement18"),
            ("Отдел корпоративной культуры", "culture20"),
            ("Отдел корпоративной стратегии", "corpstrat18"),
            ("Отдел внутреннего развития", "intdev21"),
            ("Отдел корпоративного управления", "corpmanagement19"),
            ("Отдел корпоративной культуры", "culture21"),
            ("Отдел корпоративной стратегии", "corpstrat19"),
            ("Отдел внутреннего развития", "intdev22"),
            ("Отдел корпоративного управления", "corpmanagement20"),
            ("Отдел корпоративной культуры", "culture22"),
            ("Отдел корпоративной стратегии", "corpstrat20"),
            ("Отдел внутреннего развития", "intdev23"),
            ("Отдел корпоративного управления", "corpmanagement21"),
            ("Отдел корпоративной культуры", "culture23"),
            ("Отдел корпоративной стратегии", "corpstrat21"),
            ("Отдел внутреннего развития", "intdev24"),
            ("Отдел корпоративного управления", "corpmanagement22"),
            ("Отдел корпоративной культуры", "culture24"),
            ("Отдел корпоративной стратегии", "corpstrat22"),
            ("Отдел внутреннего развития", "intdev25"),
            ("Отдел корпоративного управления", "corpmanagement23"),
            ("Отдел корпоративной культуры", "culture25"),
            ("Отдел корпоративной стратегии", "corpstrat23"),
            ("Отдел внутреннего развития", "intdev26"),
            ("Отдел корпоративного управления", "corpmanagement24"),
            ("Отдел корпоративной культуры", "culture26"),
            ("Отдел корпоративной стратегии", "corpstrat24"),
            ("Отдел внутреннего развития", "intdev27"),
            ("Отдел корпоративного управления", "corpmanagement25"),
            ("Отдел корпоративной культуры", "culture27"),
            ("Отдел корпоративной стратегии", "corpstrat25"),
            ("Отдел внутреннего развития", "intdev28"),
            ("Отдел корпоративного управления", "corpmanagement26"),
            ("Отдел корпоративной культуры", "culture28"),
            ("Отдел корпоративной стратегии", "corpstrat26"),
            ("Отдел внутреннего развития", "intdev29"),
            ("Отдел корпоративного управления", "corpmanagement27"),
            ("Отдел корпоративной культуры", "culture29"),
            ("Отдел корпоративной стратегии", "corpstrat27"),
            ("Отдел внутреннего развития", "intdev30"),
            ("Отдел корпоративного управления", "corpmanagement28"),
            ("Отдел корпоративной культуры", "culture30"),
            ("Отдел корпоративной стратегии", "corpstrat28"),
            ("Отдел внутреннего развития", "intdev31"),
            ("Отдел корпоративного управления", "corpmanagement29"),
            ("Отдел корпоративной культуры", "culture31"),
            ("Отдел корпоративной стратегии", "corpstrat29"),
            ("Отдел внутреннего развития", "intdev32"),
            ("Отдел корпоративного управления", "corpmanagement30"),
            ("Отдел корпоративной культуры", "culture32"),
            ("Отдел корпоративной стратегии", "corpstrat30"),
            ("Отдел внутреннего развития", "intdev33"),
            ("Отдел корпоративного управления", "corpmanagement31"),
            ("Отдел корпоративной культуры", "culture33"),
            ("Отдел корпоративной стратегии", "corpstrat31"),
            ("Отдел внутреннего развития", "intdev34"),
            ("Отдел корпоративного управления", "corpmanagement32"),
            ("Отдел корпоративной культуры", "culture34"),
            ("Отдел корпоративной стратегии", "corpstrat32"),
            ("Отдел внутреннего развития", "intdev35"),
            ("Отдел корпоративного управления", "corpmanagement33"),
            ("Отдел корпоративной культуры", "culture35"),
            ("Отдел корпоративной стратегии", "corpstrat33"),
            ("Отдел внутреннего развития", "intdev36"),
            ("Отдел корпоративного управления", "corpmanagement34"),
            ("Отдел корпоративной культуры", "culture36"),
            ("Отдел корпоративной стратегии", "corpstrat34"),
            ("Отдел внутреннего развития", "intdev37"),
            ("Отдел корпоративного управления", "corpmanagement35"),
            ("Отдел корпоративной культуры", "culture37"),
            ("Отдел корпоративной стратегии", "corpstrat35"),
            ("Отдел внутреннего развития", "intdev38"),
            ("Отдел корпоративного управления", "corpmanagement36"),
            ("Отдел корпоративной культуры", "culture38"),
            ("Отдел корпоративной стратегии", "corpstrat36"),
            ("Отдел внутреннего развития", "intdev39"),
            ("Отдел корпоративного управления", "corpmanagement37"),
            ("Отдел корпоративной культуры", "culture39"),
            ("Отдел корпоративной стратегии", "corpstrat37"),
            ("Отдел внутреннего развития", "intdev40"),
            ("Отдел корпоративного управления", "corpmanagement38"),
            ("Отдел корпоративной культуры", "culture40"),
            ("Отдел корпоративной стратегии", "corpstrat38"),
            ("Отдел внутреннего развития", "intdev41"),
            ("Отдел корпоративного управления", "corpmanagement39"),
            ("Отдел корпоративной культуры", "culture41"),
            ("Отдел корпоративной стратегии", "corpstrat39"),
            ("Отдел внутреннего развития", "intdev42"),
            ("Отдел корпоративного управления", "corpmanagement40"),
            ("Отдел корпоративной культуры", "culture42"),
            ("Отдел корпоративной стратегии", "corpstrat40"),
            ("Отдел внутреннего развития", "intdev43"),
            ("Отдел корпоративного управления", "corpmanagement41"),
            ("Отдел корпоративной культуры", "culture43"),
            ("Отдел корпоративной стратегии", "corpstrat41"),
            ("Отдел внутреннего развития", "intdev44"),
            ("Отдел корпоративного управления", "corpmanagement42"),
            ("Отдел корпоративной культуры", "culture44"),
            ("Отдел корпоративной стратегии", "corpstrat42"),
            ("Отдел внутреннего развития", "intdev45"),
            ("Отдел корпоративного управления", "corpmanagement43"),
            ("Отдел корпоративной культуры", "culture45"),
            ("Отдел корпоративной стратегии", "corpstrat43"),
            ("Отдел внутреннего развития", "intdev46"),
            ("Отдел корпоративного управления", "corpmanagement44"),
            ("Отдел корпоративной культуры", "culture46"),
            ("Отдел корпоративной стратегии", "corpstrat44"),
            ("Отдел внутреннего развития", "intdev47"),
            ("Отдел корпоративного управления", "corpmanagement45"),
            ("Отдел корпоративной культуры", "culture47"),
            ("Отдел корпоративной стратегии", "corpstrat45"),
            ("Отдел внутреннего развития", "intdev48"),
            ("Отдел корпоративного управления", "corpmanagement46"),
            ("Отдел корпоративной культуры", "culture48"),
            ("Отдел корпоративной стратегии", "corpstrat46"),
            ("Отдел внутреннего развития", "intdev49"),
            ("Отдел корпоративного управления", "corpmanagement47"),
            ("Отдел корпоративной культуры", "culture49"),
            ("Отдел корпоративной стратегии", "corpstrat47"),
            ("Отдел внутреннего развития", "intdev50"),
            ("Отдел корпоративного управления", "corpmanagement48"),
            ("Отдел корпоративной культуры", "culture50"),
            ("Отдел корпоративной стратегии", "corpstrat48"),
            ("Отдел внутреннего развития", "intdev51"),
            ("Отдел корпоративного управления", "corpmanagement49"),
            ("Отдел корпоративной культуры", "culture51"),
            ("Отдел корпоративной стратегии", "corpstrat49"),
            ("Отдел внутреннего развития", "intdev52"),
            ("Отдел корпоративного управления", "corpmanagement50"),
            ("Отдел корпоративной культуры", "culture52"),
            ("Отдел корпоративной стратегии", "corpstrat50"),
            ("Отдел внутреннего развития", "intdev53"),
            ("Отдел корпоративного управления", "corpmanagement51"),
            ("Отдел корпоративной культуры", "culture53"),
            ("Отдел корпоративной стратегии", "corpstrat51"),
            ("Отдел внутреннего развития", "intdev54"),
            ("Отдел корпоративного управления", "corpmanagement52"),
            ("Отдел корпоративной культуры", "culture54"),
            ("Отдел корпоративной стратегии", "corpstrat52"),
            ("Отдел внутреннего развития", "intdev55"),
            ("Отдел корпоративного управления", "corpmanagement53"),
            ("Отдел корпоративной культуры", "culture55"),
            ("Отдел корпоративной стратегии", "corpstrat53"),
            ("Отдел внутреннего развития", "intdev56"),
            ("Отдел корпоративного управления", "corpmanagement54"),
            ("Отдел корпоративной культуры", "culture56"),
            ("Отдел корпоративной стратегии", "corpstrat54"),
            ("Отдел внутреннего развития", "intdev57"),
            ("Отдел корпоративного управления", "corpmanagement55"),
            ("Отдел корпоративной культуры", "culture57"),
            ("Отдел корпоративной стратегии", "corpstrat55"),
            ("Отдел внутреннего развития", "intdev58"),
            ("Отдел корпоративного управления", "corpmanagement56"),
            ("Отдел корпоративной культуры", "culture58"),
            ("Отдел корпоративной стратегии", "corpstrat56"),
            ("Отдел внутреннего развития", "intdev59"),
            ("Отдел корпоративного управления", "corpmanagement57"),
            ("Отдел корпоративной культуры", "culture59"),
            ("Отдел корпоративной стратегии", "corpstrat57"),
            ("Отдел внутреннего развития", "intdev60"),
            ("Отдел корпоративного управления", "corpmanagement58"),
            ("Отдел корпоративной культуры", "culture60"),
            ("Отдел корпоративной стратегии", "corpstrat58"),
            ("Отдел внутреннего развития", "intdev61"),
            ("Отдел корпоративного управления", "corpmanagement59"),
            ("Отдел корпоративной культуры", "culture61"),
            ("Отдел корпоративной стратегии", "corpstrat59"),
            ("Отдел внутреннего развития", "intdev62"),
            ("Отдел корпоративного управления", "corpmanagement60"),
            ("Отдел корпоративной культуры", "culture62"),
            ("Отдел корпоративной стратегии", "corpstrat60"),
            ("Отдел внутреннего развития", "intdev63"),
            ("Отдел корпоративного управления", "corpmanagement61"),
            ("Отдел корпоративной культуры", "culture63"),
            ("Отдел корпоративной стратегии", "corpstrat61"),
            ("Отдел внутреннего развития", "intdev64"),
            ("Отдел корпоративного управления", "corpmanagement62"),
            ("Отдел корпоративной культуры", "culture64"),
            ("Отдел корпоративной стратегии", "corpstrat62"),
            ("Отдел внутреннего развития", "intdev65"),
            ("Отдел корпоративного управления", "corpmanagement63"),
            ("Отдел корпоративной культуры", "culture65"),
            ("Отдел корпоративной стратегии", "corpstrat63"),
            ("Отдел внутреннего развития", "intdev66"),
            ("Отдел корпоративного управления", "corpmanagement64"),
            ("Отдел корпоративной культуры", "culture66"),
            ("Отдел корпоративной стратегии", "corpstrat64"),
            ("Отдел внутреннего развития", "intdev67"),
            ("Отдел корпоративного управления", "corpmanagement65"),
            ("Отдел корпоративной культуры", "culture67"),
            ("Отдел корпоративной стратегии", "corpstrat65"),
            ("Отдел внутреннего развития", "intdev68"),
            ("Отдел корпоративного управления", "corpmanagement66"),
            ("Отдел корпоративной культуры", "culture68"),
            ("Отдел корпоративной стратегии", "corpstrat66"),
            ("Отдел внутреннего развития", "intdev69"),
            ("Отдел корпоративного управления", "corpmanagement67"),
            ("Отдел корпоративной культуры", "culture69"),
            ("Отдел корпоративной стратегии", "corpstrat67"),
            ("Отдел внутреннего развития", "intdev70"),
            ("Отдел корпоративного управления", "corpmanagement68"),
            ("Отдел корпоративной культуры", "culture70"),
            ("Отдел корпоративной стратегии", "corpstrat68"),
            ("Отдел внутреннего развития", "intdev71"),
            ("Отдел корпоративного управления", "corpmanagement69"),
            ("Отдел корпоративной культуры", "culture71"),
            ("Отдел корпоративной стратегии", "corpstrat69"),
            ("Отдел внутреннего развития", "intdev72"),
            ("Отдел корпоративного управления", "corpmanagement70"),
            ("Отдел корпоративной культуры", "culture72"),
            ("Отдел корпоративной стратегии", "corpstrat70"),
            ("Отдел внутреннего развития", "intdev73"),
            ("Отдел корпоративного управления", "corpmanagement71"),
            ("Отдел корпоративной культуры", "culture73"),
            ("Отдел корпоративной стратегии", "corpstrat71"),
            ("Отдел внутреннего развития", "intdev74"),
            ("Отдел корпоративного управления", "corpmanagement72"),
            ("Отдел корпоративной культуры", "culture74"),
            ("Отдел корпоративной стратегии", "corpstrat72"),
            ("Отдел внутреннего развития", "intdev75"),
            ("Отдел корпоративного управления", "corpmanagement73"),
            ("Отдел корпоративной культуры", "culture75"),
            ("Отдел корпоративной стратегии", "corpstrat73"),
            ("Отдел внутреннего развития", "intdev76"),
            ("Отдел корпоративного управления", "corpmanagement74"),
            ("Отдел корпоративной культуры", "culture76"),
            ("Отдел корпоративной стратегии", "corpstrat74"),
            ("Отдел внутреннего развития", "intdev77"),
            ("Отдел корпоративного управления", "corpmanagement75"),
            ("Отдел корпоративной культуры", "culture77"),
            ("Отдел корпоративной стратегии", "corpstrat75"),
            ("Отдел внутреннего развития", "intdev78"),
            ("Отдел корпоративного управления", "corpmanagement76"),
            ("Отдел корпоративной культуры", "culture78"),
            ("Отдел корпоративной стратегии", "corpstrat76"),
            ("Отдел внутреннего развития", "intdev79"),
            ("Отдел корпоративного управления", "corpmanagement77"),
            ("Отдел корпоративной культуры", "culture79"),
            ("Отдел корпоративной стратегии", "corpstrat77"),
            ("Отдел внутреннего развития", "intdev80"),
            ("Отдел корпоративного управления", "corpmanagement78"),
            ("Отдел корпоративной культуры", "culture80"),
            ("Отдел корпоративной стратегии", "corpstrat78"),
            ("Отдел внутреннего развития", "intdev81"),
            ("Отдел корпоративного управления", "corpmanagement79"),
            ("Отдел корпоративной культуры", "culture81"),
            ("Отдел корпоративной стратегии", "corpstrat79"),
            ("Отдел внутреннего развития", "intdev82"),
            ("Отдел корпоративного управления", "corpmanagement80"),
            ("Отдел корпоративной культуры", "culture82"),
            ("Отдел корпоративной стратегии", "corpstrat80"),
            ("Отдел внутреннего развития", "intdev83"),
            ("Отдел корпоративного управления", "corpmanagement81"),
            ("Отдел корпоративной культуры", "culture83"),
            ("Отдел корпоративной стратегии", "corpstrat81"),
            ("Отдел внутреннего развития", "intdev84"),
            ("Отдел корпоративного управления", "corpmanagement82"),
            ("Отдел корпоративной культуры", "culture84"),
            ("Отдел корпоративной стратегии", "corpstrat82"),
            ("Отдел внутреннего развития", "intdev85"),
            ("Отдел корпоративного управления", "corpmanagement83"),
            ("Отдел корпоративной культуры", "culture85"),
            ("Отдел корпоративной стратегии", "corpstrat83"),
            ("Отдел внутреннего развития", "intdev86"),
            ("Отдел корпоративного управления", "corpmanagement84"),
            ("Отдел корпоративной культуры", "culture86"),
            ("Отдел корпоративной стратегии", "corpstrat84"),
            ("Отдел внутреннего развития", "intdev87"),
            ("Отдел корпоративного управления", "corpmanagement85"),
            ("Отдел корпоративной культуры", "culture87"),
            ("Отдел корпоративной стратегии", "corpstrat85"),
            ("Отдел внутреннего развития", "intdev88"),
            ("Отдел корпоративного управления", "corpmanagement86"),
            ("Отдел корпоративной культуры", "culture88"),
            ("Отдел корпоративной стратегии", "corpstrat86"),
            ("Отдел внутреннего развития", "intdev89"),
            ("Отдел корпоративного управления", "corpmanagement87"),
            ("Отдел корпоративной культуры", "culture89"),
            ("Отдел корпоративной стратегии", "corpstrat87"),
            ("Отдел внутреннего развития", "intdev90"),
            ("Отдел корпоративного управления", "corpmanagement88"),
            ("Отдел корпоративной культуры", "culture90"),
            ("Отдел корпоративной стратегии", "corpstrat88"),
            ("Отдел внутреннего развития", "intdev91"),
            ("Отдел корпоративного управления", "corpmanagement89"),
            ("Отдел корпоративной культуры", "culture91"),
            ("Отдел корпоративной стратегии", "corpstrat89"),
            ("Отдел внутреннего развития", "intdev92"),
            ("Отдел корпоративного управления", "corpmanagement90"),
            ("Отдел корпоративной культуры", "culture92"),
            ("Отдел корпоративной стратегии", "corpstrat90"),
            ("Отдел внутреннего развития", "intdev93"),
            ("Отдел корпоративного управления", "corpmanagement91"),
            ("Отдел корпоративной культуры", "culture93"),
            ("Отдел корпоративной стратегии", "corpstrat91"),
            ("Отдел внутреннего развития", "intdev94"),
            ("Отдел корпоративного управления", "corpmanagement92"),
            ("Отдел корпоративной культуры", "culture94"),
            ("Отдел корпоративной стратегии", "corpstrat92"),
            ("Отдел внутреннего развития", "intdev95"),
            ("Отдел корпоративного управления", "corpmanagement93"),
            ("Отдел корпоративной культуры", "culture95"),
            ("Отдел корпоративной стратегии", "corpstrat93"),
            ("Отдел внутреннего развития", "intdev96"),
            ("Отдел корпоративного управления", "corpmanagement94"),
            ("Отдел корпоративной культуры", "culture96"),
            ("Отдел корпоративной стратегии", "corpstrat94"),
            ("Отдел внутреннего развития", "intdev97"),
            ("Отдел корпоративного управления", "corpmanagement95"),
            ("Отдел корпоративной культуры", "culture97"),
            ("Отдел корпоративной стратегии", "corpstrat95"),
            ("Отдел внутреннего развития", "intdev98"),
            ("Отдел корпоративного управления", "corpmanagement96"),
            ("Отдел корпоративной культуры", "culture98"),
            ("Отдел корпоративной стратегии", "corpstrat96"),
            ("Отдел внутреннего развития", "intdev99"),
            ("Отдел корпоративного управления", "corpmanagement97"),
            ("Отдел корпоративной культуры", "culture99"),
            ("Отдел корпоративной стратегии", "corpstrat97"),
            ("Отдел внутреннего развития", "intdev100"),
            ("Отдел корпоративного управления", "corpmanagement98"),
            ("Отдел корпоративной культуры", "culture100"),
            ("Отдел корпоративной стратегии", "corpstrat98"),
            ("Отдел внутреннего развития", "intdev101"),
            ("Отдел корпоративного управления", "corpmanagement99"),
            ("Отдел корпоративной культуры", "culture101"),
            ("Отдел корпоративной стратегии", "corpstrat99"),
            ("Отдел внутреннего развития", "intdev102"),
            ("Отдел корпоративного управления", "corpmanagement100"),
            ("Отдел корпоративной культуры", "culture102"),
            ("Отдел корпоративной стратегии", "corpstrat100"),
        };

        Dictionary<string, Department> departmentMap = [];

        foreach (var (name, identifier) in seedDepartments)
        {
            Result<DepartmentName> nameResult = DepartmentName.Create(name);
            if (nameResult.IsFailure)
            {
                _logger.Warning(
                    "Skipping department '{Name}' due to invalid name: {Error}",
                    name,
                    nameResult.Error
                );
                continue;
            }

            if (await _nameUniquesnessStub.HasWithName(nameResult))
            {
                _logger.Warning(
                    "Skipping department '{Name}' due to not unique name",
                    nameResult.Value
                );
                continue;
            }

            Result<DepartmentIdentifier> identifierResult = DepartmentIdentifier.Create(identifier);
            if (identifierResult.IsFailure)
            {
                _logger.Warning(
                    "Skipping department '{Name}' due to invalid identifier '{Identifier}': {Error}",
                    name,
                    identifier,
                    identifierResult.Error
                );
                continue;
            }

            // Выбираем случайное количество локаций: от 1 до 3
            int locationCount = _random.Next(1, Math.Min(4, locations.Count + 1));
            var selectedLocations = locations
                .OrderBy(_ => _random.Next())
                .Take(locationCount)
                .ToList();

            var department = Department.CreateNew(
                nameResult.Value,
                identifierResult.Value,
                selectedLocations
            );

            departments.Add(department);
            departmentMap[identifier] = department;
        }

        // Список родитель-дочерние отношения
        var departmentRelationships = new[]
        {
            // Группа разработки
            (
                "dev",
                new[]
                {
                    "mobile",
                    "frontend",
                    "backend",
                    "qa",
                    "arch",
                    "data",
                    "ml",
                    "ai",
                    "devops",
                    "infra",
                    "networking",
                    "sysadmin",
                    "cybersec",
                    "infosec",
                    "product",
                    "ux",
                    "research",
                    "innovation",
                    "digital",
                    "integrations",
                    "datagov",
                    "dataquality",
                    "monitoring",
                    "efficiency",
                    "digitalsec",
                    "knowledge",
                    "automation",
                    "digitalservices",
                    "processaudit",
                    "bizanalyst",
                    "pmo",
                }
            ),
            (
                "marketing",
                new[]
                {
                    "advertising",
                    "content",
                    "socialmedia",
                    "marketinganalytics",
                    "branding",
                    "stratmarketing",
                }
            ),
            (
                "hr",
                new[]
                {
                    "recruitment",
                    "lnd",
                    "compben",
                    "od",
                    "culture",
                    "personnel",
                    "evaluation",
                    "career",
                    "motivation",
                    "wellness",
                    "corptraining",
                    "leaddev",
                }
            ),
            (
                "finance",
                new[]
                {
                    "accounting",
                    "tax",
                    "audit",
                    "treasury",
                    "budgeting",
                    "managementaccounting",
                    "reporting",
                    "corpreporting",
                    "insurance",
                    "risk",
                }
            ),
            (
                "legal",
                new[]
                {
                    "ip",
                    "contracts",
                    "compliance",
                    "corplaw",
                    "labourlaw",
                    "intllegal",
                    "licensing",
                    "legalrisk",
                    "corpgov",
                    "corpgovernance",
                }
            ),
            (
                "support",
                new[] { "customerservice", "usersupport", "techsupport", "feedback", "cx" }
            ),
            (
                "admin",
                new[]
                {
                    "docs",
                    "facilities",
                    "travel",
                    "events",
                    "archive",
                    "internalcontrol",
                    "accesscontrol",
                    "incident",
                }
            ),
            (
                "compliance",
                new[]
                {
                    "ethics",
                    "internalcomms",
                    "safety",
                    "sustainability",
                    "csr",
                    "sustdev",
                    "corpsec",
                    "intsec",
                }
            ),
            (
                "strategy",
                new[]
                {
                    "corpdev",
                    "stratplan",
                    "corpstrategy",
                    "stratinitiatives",
                    "corpchanges",
                    "changemgmt",
                }
            ),
            (
                "ops",
                new[]
                {
                    "procurement",
                    "logistics",
                    "supplychain",
                    "itprocurement",
                    "equipproc",
                    "resourceplanning",
                    "budgetmgmt",
                    "projectmgmt",
                }
            ),
        };

        foreach (var (parentIdentifier, childIdentifiers) in departmentRelationships)
        {
            if (!departmentMap.TryGetValue(parentIdentifier, out var parent))
            {
                _logger.Warning("Parent department '{ParentId}' not found.", parentIdentifier);
                continue;
            }

            foreach (var childId in childIdentifiers)
            {
                if (!departmentMap.TryGetValue(childId, out var child))
                {
                    _logger.Warning("Child department '{ChildId}' not found.", childId);
                    continue;
                }

                var attachResult = parent.AttachOtherDepartment(child);
                if (attachResult.IsFailure)
                {
                    _logger.Warning(
                        "Failed to attach '{Child}' to '{Parent}': {Error}",
                        child.Identifier.Value,
                        parent.Identifier.Value,
                        attachResult.Error
                    );
                }
            }
        }

        if (departments.Count == 0)
        {
            _logger.Warning("No valid departments to seed.");
            return;
        }

        _dbContext.Departments.AddRange(departments);
        await _dbContext.SaveChangesAsync();

        _logger.Information("Successfully seeded {Count} departments.", departments.Count);
    }
}
